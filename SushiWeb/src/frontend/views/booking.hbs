<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Booking Page</title>
    <link rel="stylesheet" href="/styles.css">
</head>
<body>

    <!-- Display any error or success messages -->
    {{#if errorMessage}}
        <div class="error">{{errorMessage}}</div>
    {{/if}}

    {{#if successMessage}}
        <div class="success">{{successMessage}}</div>
    {{/if}}

    <!-- Booking Form -->
    <h2>Make a Booking</h2>
    <form action="/booking" method="POST">
        <div>
            <label for="NgayDen">Arrival Date:</label>
            <input type="date" name="NgayDen" required>
        </div>

        <div>
            <label for="GioDen">Arrival Time:</label>
            <input type="time" name="GioDen" required>
        </div>

        {{!-- <div>
            <label for="GioDen">Arrival Time:</label>
            <input type="text" name="GioDen" required>
        </div> --}}

        <div>
            <label for="SoLuongKhach">Number of Guests:</label>
            <input type="number" name="SoLuongKhach" required>
        </div>

        <div>
            <label for="GhiChu">Notes (Your name will be inserted here):</label>
            <input type="text" name="GhiChu" placeholder="Your name" required>
        </div>

        <div>
            <label for="SDT">Phone Number:</label>
            <input type="text" name="SDT" required>
        </div>

        <div>
            <label for="MaChiNhanh">Branch:</label>
            <select name="MaChiNhanh" id="branch-select" required>
                <option>Loading branches...</option>
            </select>
        </div>

        <button type="submit">Submit Booking</button>
    </form>

    <!-- Existing Bookings -->
    <script>
        // Fetch the branch data when the page loads
        fetch('/booking/branches') // Call the backend API endpoint for branches
            .then(response => response.json())
            .then(data => {
                const branchSelect = document.getElementById('branch-select');
                
                // If branches are found, populate the dropdown
                if (data && data.length > 0) {
                    data.forEach(branch => {
                        const option = document.createElement('option');
                        option.value = branch.MACHINHANH; // value is the branch code
                        option.textContent = branch.TENCHINHANH; // text is the branch name
                        branchSelect.appendChild(option);
                    });
                } else {
                    // If no branches are available, show a "no branches" option
                    branchSelect.innerHTML = '<option>No branches available</option>';
                }
            })
            .catch(error => {
                console.error("Error fetching branches:", error);
                const branchSelect = document.getElementById('branch-select');
                branchSelect.innerHTML = '<option>Error loading branches</option>';
            });
    </script>

</body>
</html>
